
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Indices and Missing Values Exercises &#8212; Practical Data Science</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="Indices-and-Missing-Values-Exercises">
<h1>Indices and Missing Values Exercises<a class="headerlink" href="#Indices-and-Missing-Values-Exercises" title="Permalink to this headline">¶</a></h1>
<p>One of the defining features of <code class="docutils literal notranslate"><span class="pre">pandas</span></code> is the use of indices for data alignment. Like many features in <code class="docutils literal notranslate"><span class="pre">pandas</span></code>, it can make live very easy, but if you aren’t careful, it can also lead to problems. This is especially true because indices lead to behavior that is very different from what one sees in other languages and library (like <code class="docutils literal notranslate"><span class="pre">R</span></code>, <code class="docutils literal notranslate"><span class="pre">numpy</span></code>, and <code class="docutils literal notranslate"><span class="pre">julia</span></code>). So let’s spend a little timing practicing interacting with indices (and missing values)!</p>
<div class="section" id="Missing-Values">
<h2>Missing Values<a class="headerlink" href="#Missing-Values" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Exercise-1">
<h3>Exercise 1<a class="headerlink" href="#Exercise-1" title="Permalink to this headline">¶</a></h3>
<p>Today, we will be using the ACS data we used during out first <code class="docutils literal notranslate"><span class="pre">pandas</span></code> exercise to examine the US income distribution, and how it varies by race. Note that because the US income distribution has a very small number of people with <em>extremely</em> high incomes, and the ACS is just a sample of Americans, the far right tail of the distribution will not be very well estimated. However, this data should suffice for helping to understand wealth inequality in the United States.</p>
<p>To begin, load the ACS Data we used in our first pandas exercise. That <a class="reference external" href="https://github.com/nickeubank/MIDS_Data/tree/master/US_AmericanCommunitySurvey">data can be found here</a>. We’ll be working with <code class="docutils literal notranslate"><span class="pre">US_ACS_2017_10pct_sample.dta</span></code>.</p>
</div>
<div class="section" id="Exercise-2">
<h3>Exercise 2<a class="headerlink" href="#Exercise-2" title="Permalink to this headline">¶</a></h3>
<p>Let’s begin by calculating the median US incomes from this data (recall that income is stored in the <code class="docutils literal notranslate"><span class="pre">inctot</span></code> variable).</p>
</div>
<div class="section" id="Exercise-3">
<h3>Exercise 3<a class="headerlink" href="#Exercise-3" title="Permalink to this headline">¶</a></h3>
<p>Hmmm… That doesn’t look right. The average American is definitely not earning 1.7 million dollars a year. Let’s look at the values of <code class="docutils literal notranslate"><span class="pre">inctot</span></code> using <code class="docutils literal notranslate"><span class="pre">value_counts()</span></code>. Do you see a problem?</p>
<p>Now use <code class="docutils literal notranslate"><span class="pre">value_counts()</span></code> with the argument <code class="docutils literal notranslate"><span class="pre">normalize=True</span></code> to see proportions of the sample that report each value instead of the count of people in each category. What percentage of our sample has an income of 9,999,999? What percentage has an income of 0?</p>
</div>
<div class="section" id="Exercise-4">
<h3>Exercise 4<a class="headerlink" href="#Exercise-4" title="Permalink to this headline">¶</a></h3>
<p>As we discussed before, the ACS uses a value of 9999999 to denote that income information is not available for someone. The problem with using this kind of “sentinel value” is that pandas doesn’t understand that this is supposed to denote missing data, and so when it averages the variable, it doesn’t know to ignore 9999999.</p>
<p>To help out <code class="docutils literal notranslate"><span class="pre">pandas</span></code>, use the <code class="docutils literal notranslate"><span class="pre">replace</span></code> command to replace all values of 9999999 with <code class="docutils literal notranslate"><span class="pre">np.nan</span></code>.</p>
</div>
<div class="section" id="Exercise-5">
<h3>Exercise 5<a class="headerlink" href="#Exercise-5" title="Permalink to this headline">¶</a></h3>
<p>Now that we’ve properly labeled our missing data as <code class="docutils literal notranslate"><span class="pre">np.nan</span></code>, let’s calculate the average US income once more.</p>
</div>
<div class="section" id="Exercise-6">
<h3>Exercise 6<a class="headerlink" href="#Exercise-6" title="Permalink to this headline">¶</a></h3>
<p>OK, now that seems like a reasonable number. As we can see, a major advantage of using <code class="docutils literal notranslate"><span class="pre">np.nan</span></code> is that <code class="docutils literal notranslate"><span class="pre">pandas</span></code> knows that <code class="docutils literal notranslate"><span class="pre">np.nan</span></code> observations should just be ignored when we are calculating means.</p>
<p>However, as we previously noted, there are a lot of observations of zero income in our data, and it’s not clear that we want everyone with a zero-income <em>should</em> be included in this average, since those may be people who are retired, or in school.</p>
<p>Let’s limit our attention to people who are currently working by using <code class="docutils literal notranslate"><span class="pre">empstat</span></code> to subset for people who are currently working. Remember you can use <code class="docutils literal notranslate"><span class="pre">value_counts()</span></code> to see what values of <code class="docutils literal notranslate"><span class="pre">empstat</span></code> are in the data!</p>
</div>
<div class="section" id="Exercise-7">
<h3>Exercise 7<a class="headerlink" href="#Exercise-7" title="Permalink to this headline">¶</a></h3>
<p>Now suppose that we want to find the minimum age of everyone who has an income reported. In other words, we want to <em>ignore</em> all the rows that have a missing value for <code class="docutils literal notranslate"><span class="pre">inctot</span></code>, then calculate the minimum value of age for those people.</p>
</div>
</div>
<div class="section" id="Index-alignment">
<h2>Index alignment<a class="headerlink" href="#Index-alignment" title="Permalink to this headline">¶</a></h2>
<p>To illustrate how index alignment can sometimes lead to problems, let’s consider the following example: suppose we’re throwing a party, and we plan to give people prizes based on the order in which they arrive. The first person to arrive at the party will get 20 dollars, the second will get 10 dollars, and the third person doesn’t get anything.</p>
<p>To keep track of how many prizes everyone gets, we build a DataFrame with all the party attendees, their arrival order, and a column for keeping track of how much they’ve received in prizes.</p>
<p>The we can also build a Series with the prize amounts we plan to give people.</p>
<div class="section" id="Exercise-8">
<h3>Exercise 8<a class="headerlink" href="#Exercise-8" title="Permalink to this headline">¶</a></h3>
<p>Use the code below to get started:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="n">attendees</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;names&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Jill&quot;</span><span class="p">,</span> <span class="s2">&quot;Kumar&quot;</span><span class="p">,</span> <span class="s2">&quot;Zaira&quot;</span><span class="p">],</span>
                          <span class="s1">&#39;prizes&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                          <span class="s1">&#39;arrival_order&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="n">arrival_prizes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="Exercise-9">
<h3>Exercise 9<a class="headerlink" href="#Exercise-9" title="Permalink to this headline">¶</a></h3>
<p>Now let’s sort our <code class="docutils literal notranslate"><span class="pre">attendees</span></code> list by <code class="docutils literal notranslate"><span class="pre">arrival_order</span></code> so that the first row is the person who arrived first, the second is the person who arrived second, etc. to match how we’ve organized <code class="docutils literal notranslate"><span class="pre">arrival_prizes</span></code>.</p>
</div>
<div class="section" id="Exercise-10">
<h3>Exercise 10<a class="headerlink" href="#Exercise-10" title="Permalink to this headline">¶</a></h3>
<p>Now let’s “give” everyone their arrival prizes by adding arrival prizes to people’s prize column:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">attendees</span><span class="p">[</span><span class="s1">&#39;prizes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">attendees</span><span class="p">[</span><span class="s1">&#39;prizes&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">arrival_prizes</span>
</pre></div>
</div>
</div>
<div class="section" id="Exercise-11">
<h3>Exercise 11<a class="headerlink" href="#Exercise-11" title="Permalink to this headline">¶</a></h3>
<p>Now let’s look at the result. Does it look like what you expected? Do you know what went wrong?</p>
<p>After you’ve formulated your thoughts, continue to <a class="reference internal" href="Exercise_indices_missing_discussion.html"><span class="doc">Discussion</span></a>.</p>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Practical DS</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../not_a_mids_student.html">Not a MIDS Student?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../command_line_part1.html">Command Line, Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../command_line_part2.html">Command Line, Advanced</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setup_environment.html">Setting Up Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jupyter.html">Jupyter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../views_and_copies_in_pandas.html">Views in Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plotting_part1.html">Plotting, Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plotting_part2.html">Plotting, Advanced</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_help.html">Getting Help Online</a></li>
<li class="toctree-l1"><a class="reference internal" href="../git_and_github.html">Git and Github</a></li>
<li class="toctree-l1"><a class="reference internal" href="../defensive_programming.html">Defensive Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workflow.html">Workflow Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ints_and_floats.html">Numbers in Computers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../performance.html">Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cheatsheets.html">Cheatsheets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercise_list.html">All Exercises</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Nick Eubank.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/exercises/Exercise_indices_missing.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-133829453-1']);
      _gaq.push(['_setDomainName', 'none']);
      _gaq.push(['_setAllowLinker', true]);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
    
  </body>
</html>